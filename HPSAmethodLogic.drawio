<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36" version="24.7.16">
  <diagram name="Page-1" id="rRAnHk6X2ZbRFvGK7BwC">
    <mxGraphModel dx="505" dy="496" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="XxHGtYk1Bex2pzqUaoSB-2" value="Calculate the&amp;nbsp;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; text-align: start; text-wrap: nowrap; background-color: initial;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CUserObject%20label%3D%22import%20numpy%20as%20np%26%2310%3BacceptedGeometries%3D%5B&#39;Polygon&#39;%2C&#39;MultiPolygon&#39;%2C&#39;GeometryCollection&#39;%5D%20%23sometimes%20the%20clip%20function%20provided%20a%20wierd%20output%20like%20point%20data%20or%20line%26%2310%3B%26%2310%3B%26%2310%3BnoHpsa%3D0%26%2310%3BfullCoverage%3D0%26%2310%3BpartialOne%3D0%26%2310%3Bseveral%3D0%26%2310%3B%26%2310%3B%26%2310%3B%23Process%20takes%20one%20county%20at%20the%20time%2C%20clips%20it%2C%20chooses%20only%20polygon%20related%20geometry%2C%20calculates%20area%20for%20regions%20that%20have%20the%20same%20FIPS%20as%20the%20county.%26%2310%3B%23Prior%20to%20assigning%20scores%2C%20we%20filter%20out%20regions%20that%20are%20very%20small%2C%20or%20those%20that%20a%20proportion%20highier%20than%20the%20county.%C2%A0%26%2310%3B%23%20and%20assign%20score%26%2310%3Bfor%20GEOID%20in%20counties%5B&#39;GEOID&#39;%5D.unique()%3A%26%2310%3B%C2%A0%20%C2%A0%20tcounty%20%3D%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%5D%26%2310%3B%C2%A0%20%C2%A0%20CountyArea%20%3D%20(tcounty%5B&#39;geometry&#39;%5D.area%2F%2010**6).values%5B0%5D%20%23square%20kilometers%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20cfips%3Dtcounty%5B&#39;STATEFP&#39;%5D.values%5B0%5D%23State%20FIPS%20to%20filter%20HPSA%20regions%20to%20the%20same%20state%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23counties%5B%26quot%3Barea%26quot%3B%5D%20%3D%20counties%5B&#39;geometry&#39;%5D.area%2F%2010**6%20%23square%20kilometers%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20gpd.clip(hpsa%2Ctcounty)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t.loc%5Bt.geometry.type.isin(acceptedGeometries)%5D.copy()%26%2310%3B%C2%A0%20%C2%A0%20t%3Dt%5B(t%5B&#39;PriStFips&#39;%5D%3D%3Dcfips)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;area&#39;%5D%3Dt%5B&#39;geometry&#39;%5D.area%2F%2010**6%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23%20Filter%20out%20polygons%20that%20are%20too%20small%20or%20too%20large%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;hpsaArea&#39;%5D%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;area&#39;%5D%20%26gt%3B0.0005)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26lt%3B1.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26gt%3B0.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23Loop%20that%20assigns%20values%C2%A0%20%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20if%20len(t)%20%3D%3D%200%3A%20%23%20When%20there%20are%20no%20regions%2C%20assign%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20noHpsa%3DnoHpsa%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26gt%3B0.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20greater%20than%200.97%2C%20assign%20HPSA%20score%20to%20all%20county%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20t%5B&#39;HpsScore&#39;%5D.values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20fullCoverage%3DfullCoverage%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26lt%3B%200.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20less%20than%200.97%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea%20*%20t%5B&#39;HpsScore&#39;%5D).values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20int(round(weighted_score))%23%20output%20in%20integer%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20partialOne%3DpartialOne%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%26gt%3B%201%3A%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%23%20When%20the%20length%20is%20greater%20than%201%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%20and%20sum%20it%20for%20all%20counties%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score_sum%20%3D%20((t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%20*%20t%5B&#39;HpsScore&#39;%5D).sum()%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20final_score%20%3D%20int(round(weighted_score_sum))%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20min(final_score%2C%2023)%23set%20the%20max%20possible%20score%20as%2023%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20several%3Dseveral%2B1%26%2310%3B%26%2310%3B%26%2310%3Bprint(&#39;Done%20Processing%20Data&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(f&#39;%20Counties%20with%20no%20HPSA%20%7BnoHpsa%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20full%20Coverage%20%7BfullCoverage%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20partial%20coverage%20%7BpartialOne%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20several%20regions%20%7Bseveral%7D&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(counties%5B&#39;HpsScore&#39;%5D.describe())%22%20link%3D%22import%20numpy%20as%20np%26%2310%3BacceptedGeometries%3D%5B&#39;Polygon&#39;%2C&#39;MultiPolygon&#39;%2C&#39;GeometryCollection&#39;%5D%20%23sometimes%20the%20clip%20function%20provided%20a%20wierd%20output%20like%20point%20data%20or%20line%26%2310%3B%26%2310%3B%26%2310%3BnoHpsa%3D0%26%2310%3BfullCoverage%3D0%26%2310%3BpartialOne%3D0%26%2310%3Bseveral%3D0%26%2310%3B%26%2310%3B%26%2310%3B%23Process%20takes%20one%20county%20at%20the%20time%2C%20clips%20it%2C%20chooses%20only%20polygon%20related%20geometry%2C%20calculates%20area%20for%20regions%20that%20have%20the%20same%20FIPS%20as%20the%20county.%26%2310%3B%23Prior%20to%20assigning%20scores%2C%20we%20filter%20out%20regions%20that%20are%20very%20small%2C%20or%20those%20that%20a%20proportion%20highier%20than%20the%20county.%C2%A0%26%2310%3B%23%20and%20assign%20score%26%2310%3Bfor%20GEOID%20in%20counties%5B&#39;GEOID&#39;%5D.unique()%3A%26%2310%3B%C2%A0%20%C2%A0%20tcounty%20%3D%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%5D%26%2310%3B%C2%A0%20%C2%A0%20CountyArea%20%3D%20(tcounty%5B&#39;geometry&#39;%5D.area%2F%2010**6).values%5B0%5D%20%23square%20kilometers%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20cfips%3Dtcounty%5B&#39;STATEFP&#39;%5D.values%5B0%5D%23State%20FIPS%20to%20filter%20HPSA%20regions%20to%20the%20same%20state%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23counties%5B%26quot%3Barea%26quot%3B%5D%20%3D%20counties%5B&#39;geometry&#39;%5D.area%2F%2010**6%20%23square%20kilometers%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20gpd.clip(hpsa%2Ctcounty)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t.loc%5Bt.geometry.type.isin(acceptedGeometries)%5D.copy()%26%2310%3B%C2%A0%20%C2%A0%20t%3Dt%5B(t%5B&#39;PriStFips&#39;%5D%3D%3Dcfips)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;area&#39;%5D%3Dt%5B&#39;geometry&#39;%5D.area%2F%2010**6%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23%20Filter%20out%20polygons%20that%20are%20too%20small%20or%20too%20large%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;hpsaArea&#39;%5D%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;area&#39;%5D%20%26gt%3B0.0005)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26lt%3B1.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26gt%3B0.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23Loop%20that%20assigns%20values%C2%A0%20%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20if%20len(t)%20%3D%3D%200%3A%20%23%20When%20there%20are%20no%20regions%2C%20assign%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20noHpsa%3DnoHpsa%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26gt%3B0.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20greater%20than%200.97%2C%20assign%20HPSA%20score%20to%20all%20county%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20t%5B&#39;HpsScore&#39;%5D.values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20fullCoverage%3DfullCoverage%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26lt%3B%200.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20less%20than%200.97%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea%20*%20t%5B&#39;HpsScore&#39;%5D).values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20int(round(weighted_score))%23%20output%20in%20integer%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20partialOne%3DpartialOne%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%26gt%3B%201%3A%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%23%20When%20the%20length%20is%20greater%20than%201%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%20and%20sum%20it%20for%20all%20counties%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score_sum%20%3D%20((t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%20*%20t%5B&#39;HpsScore&#39;%5D).sum()%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20final_score%20%3D%20int(round(weighted_score_sum))%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20min(final_score%2C%2023)%23set%20the%20max%20possible%20score%20as%2023%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20several%3Dseveral%2B1%26%2310%3B%26%2310%3B%26%2310%3Bprint(&#39;Done%20Processing%20Data&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(f&#39;%20Counties%20with%20no%20HPSA%20%7BnoHpsa%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20full%20Coverage%20%7BfullCoverage%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20partial%20coverage%20%7BpartialOne%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20several%20regions%20%7Bseveral%7D&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(counties%5B&#39;HpsScore&#39;%5D.describe())%22%20id%3D%222%22%3E%3CmxCell%20style%3D%22text%3BwhiteSpace%3Dwrap%3B%22%20vertex%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%2210%22%20y%3D%2270%22%20width%3D%22560%22%20height%3D%221020%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2FUserObject%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;/span&gt;county area&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="190" y="570" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="XxHGtYk1Bex2pzqUaoSB-3" value="Iterate for&amp;nbsp;&lt;div&gt;each County&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="580" width="140" height="130" as="geometry" />
        </mxCell>
        <mxCell id="XxHGtYk1Bex2pzqUaoSB-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="XxHGtYk1Bex2pzqUaoSB-4" target="XxHGtYk1Bex2pzqUaoSB-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XxHGtYk1Bex2pzqUaoSB-7" value="Keeping only accepted geometry" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="XxHGtYk1Bex2pzqUaoSB-6">
          <mxGeometry x="-0.3579" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XxHGtYk1Bex2pzqUaoSB-4" value="Clip county geometry to HPSA Layer" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="320" y="570" width="140" height="70" as="geometry" />
        </mxCell>
        <mxCell id="XxHGtYk1Bex2pzqUaoSB-5" value="Clip county geometry to HPSA Layer" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="470" y="570" width="140" height="70" as="geometry" />
        </mxCell>
        <mxCell id="XxHGtYk1Bex2pzqUaoSB-8" value="Calculate the&amp;nbsp;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; text-align: start; text-wrap: nowrap; background-color: initial;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CUserObject%20label%3D%22import%20numpy%20as%20np%26%2310%3BacceptedGeometries%3D%5B&#39;Polygon&#39;%2C&#39;MultiPolygon&#39;%2C&#39;GeometryCollection&#39;%5D%20%23sometimes%20the%20clip%20function%20provided%20a%20wierd%20output%20like%20point%20data%20or%20line%26%2310%3B%26%2310%3B%26%2310%3BnoHpsa%3D0%26%2310%3BfullCoverage%3D0%26%2310%3BpartialOne%3D0%26%2310%3Bseveral%3D0%26%2310%3B%26%2310%3B%26%2310%3B%23Process%20takes%20one%20county%20at%20the%20time%2C%20clips%20it%2C%20chooses%20only%20polygon%20related%20geometry%2C%20calculates%20area%20for%20regions%20that%20have%20the%20same%20FIPS%20as%20the%20county.%26%2310%3B%23Prior%20to%20assigning%20scores%2C%20we%20filter%20out%20regions%20that%20are%20very%20small%2C%20or%20those%20that%20a%20proportion%20highier%20than%20the%20county.%C2%A0%26%2310%3B%23%20and%20assign%20score%26%2310%3Bfor%20GEOID%20in%20counties%5B&#39;GEOID&#39;%5D.unique()%3A%26%2310%3B%C2%A0%20%C2%A0%20tcounty%20%3D%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%5D%26%2310%3B%C2%A0%20%C2%A0%20CountyArea%20%3D%20(tcounty%5B&#39;geometry&#39;%5D.area%2F%2010**6).values%5B0%5D%20%23square%20kilometers%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20cfips%3Dtcounty%5B&#39;STATEFP&#39;%5D.values%5B0%5D%23State%20FIPS%20to%20filter%20HPSA%20regions%20to%20the%20same%20state%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23counties%5B%26quot%3Barea%26quot%3B%5D%20%3D%20counties%5B&#39;geometry&#39;%5D.area%2F%2010**6%20%23square%20kilometers%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20gpd.clip(hpsa%2Ctcounty)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t.loc%5Bt.geometry.type.isin(acceptedGeometries)%5D.copy()%26%2310%3B%C2%A0%20%C2%A0%20t%3Dt%5B(t%5B&#39;PriStFips&#39;%5D%3D%3Dcfips)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;area&#39;%5D%3Dt%5B&#39;geometry&#39;%5D.area%2F%2010**6%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23%20Filter%20out%20polygons%20that%20are%20too%20small%20or%20too%20large%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;hpsaArea&#39;%5D%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;area&#39;%5D%20%26gt%3B0.0005)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26lt%3B1.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26gt%3B0.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23Loop%20that%20assigns%20values%C2%A0%20%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20if%20len(t)%20%3D%3D%200%3A%20%23%20When%20there%20are%20no%20regions%2C%20assign%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20noHpsa%3DnoHpsa%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26gt%3B0.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20greater%20than%200.97%2C%20assign%20HPSA%20score%20to%20all%20county%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20t%5B&#39;HpsScore&#39;%5D.values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20fullCoverage%3DfullCoverage%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26lt%3B%200.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20less%20than%200.97%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea%20*%20t%5B&#39;HpsScore&#39;%5D).values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20int(round(weighted_score))%23%20output%20in%20integer%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20partialOne%3DpartialOne%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%26gt%3B%201%3A%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%23%20When%20the%20length%20is%20greater%20than%201%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%20and%20sum%20it%20for%20all%20counties%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score_sum%20%3D%20((t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%20*%20t%5B&#39;HpsScore&#39;%5D).sum()%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20final_score%20%3D%20int(round(weighted_score_sum))%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20min(final_score%2C%2023)%23set%20the%20max%20possible%20score%20as%2023%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20several%3Dseveral%2B1%26%2310%3B%26%2310%3B%26%2310%3Bprint(&#39;Done%20Processing%20Data&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(f&#39;%20Counties%20with%20no%20HPSA%20%7BnoHpsa%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20full%20Coverage%20%7BfullCoverage%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20partial%20coverage%20%7BpartialOne%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20several%20regions%20%7Bseveral%7D&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(counties%5B&#39;HpsScore&#39;%5D.describe())%22%20link%3D%22import%20numpy%20as%20np%26%2310%3BacceptedGeometries%3D%5B&#39;Polygon&#39;%2C&#39;MultiPolygon&#39;%2C&#39;GeometryCollection&#39;%5D%20%23sometimes%20the%20clip%20function%20provided%20a%20wierd%20output%20like%20point%20data%20or%20line%26%2310%3B%26%2310%3B%26%2310%3BnoHpsa%3D0%26%2310%3BfullCoverage%3D0%26%2310%3BpartialOne%3D0%26%2310%3Bseveral%3D0%26%2310%3B%26%2310%3B%26%2310%3B%23Process%20takes%20one%20county%20at%20the%20time%2C%20clips%20it%2C%20chooses%20only%20polygon%20related%20geometry%2C%20calculates%20area%20for%20regions%20that%20have%20the%20same%20FIPS%20as%20the%20county.%26%2310%3B%23Prior%20to%20assigning%20scores%2C%20we%20filter%20out%20regions%20that%20are%20very%20small%2C%20or%20those%20that%20a%20proportion%20highier%20than%20the%20county.%C2%A0%26%2310%3B%23%20and%20assign%20score%26%2310%3Bfor%20GEOID%20in%20counties%5B&#39;GEOID&#39;%5D.unique()%3A%26%2310%3B%C2%A0%20%C2%A0%20tcounty%20%3D%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%5D%26%2310%3B%C2%A0%20%C2%A0%20CountyArea%20%3D%20(tcounty%5B&#39;geometry&#39;%5D.area%2F%2010**6).values%5B0%5D%20%23square%20kilometers%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20cfips%3Dtcounty%5B&#39;STATEFP&#39;%5D.values%5B0%5D%23State%20FIPS%20to%20filter%20HPSA%20regions%20to%20the%20same%20state%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23counties%5B%26quot%3Barea%26quot%3B%5D%20%3D%20counties%5B&#39;geometry&#39;%5D.area%2F%2010**6%20%23square%20kilometers%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20gpd.clip(hpsa%2Ctcounty)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t.loc%5Bt.geometry.type.isin(acceptedGeometries)%5D.copy()%26%2310%3B%C2%A0%20%C2%A0%20t%3Dt%5B(t%5B&#39;PriStFips&#39;%5D%3D%3Dcfips)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;area&#39;%5D%3Dt%5B&#39;geometry&#39;%5D.area%2F%2010**6%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23%20Filter%20out%20polygons%20that%20are%20too%20small%20or%20too%20large%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;hpsaArea&#39;%5D%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;area&#39;%5D%20%26gt%3B0.0005)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26lt%3B1.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26gt%3B0.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23Loop%20that%20assigns%20values%C2%A0%20%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20if%20len(t)%20%3D%3D%200%3A%20%23%20When%20there%20are%20no%20regions%2C%20assign%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20noHpsa%3DnoHpsa%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26gt%3B0.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20greater%20than%200.97%2C%20assign%20HPSA%20score%20to%20all%20county%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20t%5B&#39;HpsScore&#39;%5D.values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20fullCoverage%3DfullCoverage%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26lt%3B%200.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20less%20than%200.97%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea%20*%20t%5B&#39;HpsScore&#39;%5D).values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20int(round(weighted_score))%23%20output%20in%20integer%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20partialOne%3DpartialOne%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%26gt%3B%201%3A%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%23%20When%20the%20length%20is%20greater%20than%201%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%20and%20sum%20it%20for%20all%20counties%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score_sum%20%3D%20((t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%20*%20t%5B&#39;HpsScore&#39;%5D).sum()%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20final_score%20%3D%20int(round(weighted_score_sum))%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20min(final_score%2C%2023)%23set%20the%20max%20possible%20score%20as%2023%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20several%3Dseveral%2B1%26%2310%3B%26%2310%3B%26%2310%3Bprint(&#39;Done%20Processing%20Data&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(f&#39;%20Counties%20with%20no%20HPSA%20%7BnoHpsa%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20full%20Coverage%20%7BfullCoverage%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20partial%20coverage%20%7BpartialOne%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20several%20regions%20%7Bseveral%7D&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(counties%5B&#39;HpsScore&#39;%5D.describe())%22%20id%3D%222%22%3E%3CmxCell%20style%3D%22text%3BwhiteSpace%3Dwrap%3B%22%20vertex%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%2210%22%20y%3D%2270%22%20width%3D%22560%22%20height%3D%221020%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2FUserObject%3E%3C%2Froot%3E%3C%2FmxGraphModel%p&lt;/span&gt;&amp;nbsp;area of clipped polygons&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="630" y="575" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="XxHGtYk1Bex2pzqUaoSB-9" value="Remove polygons with ration less than 0.0005 or greater than 1.001" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="330" y="670" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="XxHGtYk1Bex2pzqUaoSB-10" value="Calculate the&amp;nbsp;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; text-align: start; text-wrap: nowrap; background-color: initial;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CUserObject%20label%3D%22import%20numpy%20as%20np%26%2310%3BacceptedGeometries%3D%5B&#39;Polygon&#39;%2C&#39;MultiPolygon&#39;%2C&#39;GeometryCollection&#39;%5D%20%23sometimes%20the%20clip%20function%20provided%20a%20wierd%20output%20like%20point%20data%20or%20line%26%2310%3B%26%2310%3B%26%2310%3BnoHpsa%3D0%26%2310%3BfullCoverage%3D0%26%2310%3BpartialOne%3D0%26%2310%3Bseveral%3D0%26%2310%3B%26%2310%3B%26%2310%3B%23Process%20takes%20one%20county%20at%20the%20time%2C%20clips%20it%2C%20chooses%20only%20polygon%20related%20geometry%2C%20calculates%20area%20for%20regions%20that%20have%20the%20same%20FIPS%20as%20the%20county.%26%2310%3B%23Prior%20to%20assigning%20scores%2C%20we%20filter%20out%20regions%20that%20are%20very%20small%2C%20or%20those%20that%20a%20proportion%20highier%20than%20the%20county.%C2%A0%26%2310%3B%23%20and%20assign%20score%26%2310%3Bfor%20GEOID%20in%20counties%5B&#39;GEOID&#39;%5D.unique()%3A%26%2310%3B%C2%A0%20%C2%A0%20tcounty%20%3D%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%5D%26%2310%3B%C2%A0%20%C2%A0%20CountyArea%20%3D%20(tcounty%5B&#39;geometry&#39;%5D.area%2F%2010**6).values%5B0%5D%20%23square%20kilometers%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20cfips%3Dtcounty%5B&#39;STATEFP&#39;%5D.values%5B0%5D%23State%20FIPS%20to%20filter%20HPSA%20regions%20to%20the%20same%20state%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23counties%5B%26quot%3Barea%26quot%3B%5D%20%3D%20counties%5B&#39;geometry&#39;%5D.area%2F%2010**6%20%23square%20kilometers%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20gpd.clip(hpsa%2Ctcounty)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t.loc%5Bt.geometry.type.isin(acceptedGeometries)%5D.copy()%26%2310%3B%C2%A0%20%C2%A0%20t%3Dt%5B(t%5B&#39;PriStFips&#39;%5D%3D%3Dcfips)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;area&#39;%5D%3Dt%5B&#39;geometry&#39;%5D.area%2F%2010**6%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23%20Filter%20out%20polygons%20that%20are%20too%20small%20or%20too%20large%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;hpsaArea&#39;%5D%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;area&#39;%5D%20%26gt%3B0.0005)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26lt%3B1.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26gt%3B0.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23Loop%20that%20assigns%20values%C2%A0%20%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20if%20len(t)%20%3D%3D%200%3A%20%23%20When%20there%20are%20no%20regions%2C%20assign%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20noHpsa%3DnoHpsa%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26gt%3B0.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20greater%20than%200.97%2C%20assign%20HPSA%20score%20to%20all%20county%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20t%5B&#39;HpsScore&#39;%5D.values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20fullCoverage%3DfullCoverage%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26lt%3B%200.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20less%20than%200.97%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea%20*%20t%5B&#39;HpsScore&#39;%5D).values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20int(round(weighted_score))%23%20output%20in%20integer%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20partialOne%3DpartialOne%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%26gt%3B%201%3A%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%23%20When%20the%20length%20is%20greater%20than%201%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%20and%20sum%20it%20for%20all%20counties%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score_sum%20%3D%20((t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%20*%20t%5B&#39;HpsScore&#39;%5D).sum()%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20final_score%20%3D%20int(round(weighted_score_sum))%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20min(final_score%2C%2023)%23set%20the%20max%20possible%20score%20as%2023%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20several%3Dseveral%2B1%26%2310%3B%26%2310%3B%26%2310%3Bprint(&#39;Done%20Processing%20Data&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(f&#39;%20Counties%20with%20no%20HPSA%20%7BnoHpsa%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20full%20Coverage%20%7BfullCoverage%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20partial%20coverage%20%7BpartialOne%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20several%20regions%20%7Bseveral%7D&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(counties%5B&#39;HpsScore&#39;%5D.describe())%22%20link%3D%22import%20numpy%20as%20np%26%2310%3BacceptedGeometries%3D%5B&#39;Polygon&#39;%2C&#39;MultiPolygon&#39;%2C&#39;GeometryCollection&#39;%5D%20%23sometimes%20the%20clip%20function%20provided%20a%20wierd%20output%20like%20point%20data%20or%20line%26%2310%3B%26%2310%3B%26%2310%3BnoHpsa%3D0%26%2310%3BfullCoverage%3D0%26%2310%3BpartialOne%3D0%26%2310%3Bseveral%3D0%26%2310%3B%26%2310%3B%26%2310%3B%23Process%20takes%20one%20county%20at%20the%20time%2C%20clips%20it%2C%20chooses%20only%20polygon%20related%20geometry%2C%20calculates%20area%20for%20regions%20that%20have%20the%20same%20FIPS%20as%20the%20county.%26%2310%3B%23Prior%20to%20assigning%20scores%2C%20we%20filter%20out%20regions%20that%20are%20very%20small%2C%20or%20those%20that%20a%20proportion%20highier%20than%20the%20county.%C2%A0%26%2310%3B%23%20and%20assign%20score%26%2310%3Bfor%20GEOID%20in%20counties%5B&#39;GEOID&#39;%5D.unique()%3A%26%2310%3B%C2%A0%20%C2%A0%20tcounty%20%3D%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%5D%26%2310%3B%C2%A0%20%C2%A0%20CountyArea%20%3D%20(tcounty%5B&#39;geometry&#39;%5D.area%2F%2010**6).values%5B0%5D%20%23square%20kilometers%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20cfips%3Dtcounty%5B&#39;STATEFP&#39;%5D.values%5B0%5D%23State%20FIPS%20to%20filter%20HPSA%20regions%20to%20the%20same%20state%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23counties%5B%26quot%3Barea%26quot%3B%5D%20%3D%20counties%5B&#39;geometry&#39;%5D.area%2F%2010**6%20%23square%20kilometers%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20gpd.clip(hpsa%2Ctcounty)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t.loc%5Bt.geometry.type.isin(acceptedGeometries)%5D.copy()%26%2310%3B%C2%A0%20%C2%A0%20t%3Dt%5B(t%5B&#39;PriStFips&#39;%5D%3D%3Dcfips)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;area&#39;%5D%3Dt%5B&#39;geometry&#39;%5D.area%2F%2010**6%26%2310%3B%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23%20Filter%20out%20polygons%20that%20are%20too%20small%20or%20too%20large%26%2310%3B%C2%A0%20%C2%A0%20t%5B&#39;hpsaArea&#39;%5D%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;area&#39;%5D%20%26gt%3B0.0005)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26lt%3B1.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20t%20%3D%20t%5B(t%5B&#39;hpsaArea&#39;%5D%20%26gt%3B0.001)%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%23Loop%20that%20assigns%20values%C2%A0%20%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20if%20len(t)%20%3D%3D%200%3A%20%23%20When%20there%20are%20no%20regions%2C%20assign%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%200%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20noHpsa%3DnoHpsa%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26gt%3B0.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20greater%20than%200.97%2C%20assign%20HPSA%20score%20to%20all%20county%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20t%5B&#39;HpsScore&#39;%5D.values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20fullCoverage%3DfullCoverage%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%3D%3D%201%20and%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea).values%5B0%5D%20%26lt%3B%200.97%3A%20%23%20When%20the%20length%20is%201%2C%20and%20the%20propotion%20of%20the%20county%20covered%20by%20the%20region%20is%20less%20than%200.97%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score%20%3D%20(t%5B&#39;area&#39;%5D%20%2F%20CountyArea%20*%20t%5B&#39;HpsScore&#39;%5D).values%5B0%5D%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20int(round(weighted_score))%23%20output%20in%20integer%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20partialOne%3DpartialOne%2B1%26%2310%3B%C2%A0%20%C2%A0%20elif%20len(t)%20%26gt%3B%201%3A%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%23%20When%20the%20length%20is%20greater%20than%201%2C%20weigh%20the%20HpsScore%20for%20county%20area%20covered%20and%20sum%20it%20for%20all%20counties%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20weighted_score_sum%20%3D%20((t%5B&#39;area&#39;%5D%20%2F%20CountyArea)%20*%20t%5B&#39;HpsScore&#39;%5D).sum()%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20final_score%20%3D%20int(round(weighted_score_sum))%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20counties.loc%5Bcounties%5B&#39;GEOID&#39;%5D%20%3D%3D%20GEOID%2C%20&#39;HpsScore&#39;%5D%20%3D%20min(final_score%2C%2023)%23set%20the%20max%20possible%20score%20as%2023%C2%A0%26%2310%3B%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20several%3Dseveral%2B1%26%2310%3B%26%2310%3B%26%2310%3Bprint(&#39;Done%20Processing%20Data&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(f&#39;%20Counties%20with%20no%20HPSA%20%7BnoHpsa%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20full%20Coverage%20%7BfullCoverage%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20partial%20coverage%20%7BpartialOne%7D&#39;)%26%2310%3Bprint(f&#39;%20Counties%20with%20several%20regions%20%7Bseveral%7D&#39;)%26%2310%3B%26%2310%3B%26%2310%3Bprint(counties%5B&#39;HpsScore&#39;%5D.describe())%22%20id%3D%222%22%3E%3CmxCell%20style%3D%22text%3BwhiteSpace%3Dwrap%3B%22%20vertex%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%2210%22%20y%3D%2270%22%20width%3D%22560%22%20height%3D%221020%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2FUserObject%3E%3C%2Froot%3E%3C%2FmxGraphModel%p&lt;/span&gt;ratio of hpsa area to county&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="190" y="670" width="120" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
